<?xml version="1.0"?>
<openerp>
    <data>

        <!-- Extending presupuesto compromiso Form View -->
        <record id="view_presupuesto_move_compromiso_inherit_form" model="ir.ui.view">
           <field name="inherit_id" ref="presupuesto.view_presupuesto_compromiso_move_form"/>
            <field name="model">presupuesto.move</field>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='move_rel']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <field name="move_rel" position="after" >
                    <field name="presupuesto_rel_move" widget="many2many_tags" domain="[('doc_type', '=', 'cdp')]" String="CDP"/>
                    <field name="compute_data" invisible="1"/>
                </field>

                <xpath expr="//field[@name='gastos_ids']" position="replace">
					<field name="gastos_ids" nolabel='1' context="{'move_id' : id}">
						<tree string="Rubros" editable="bottom" create='false'>
							<field name="move_id" invisible="1" />
							<field name="rubros_id" domain="[('rubro_nivel', '=', 'D'), ('rubro_tipo', '=', 'G')]"/>
							<field name="mov_type" />
							<field name="saldo_move"/>
							<field name="ammount"/>
							<field name="notas"/>
                            <field name="presupuesto_move_name"/>
						</tree>
					</field>
                </xpath>

            </field>
        </record>

        <!-- Extending presupuesto obligacion Form View -->
        <record id="view_presupuesto_move_obligacion_inherit_form" model="ir.ui.view">
           <field name="inherit_id" ref="presupuesto.view_presupuesto_obligacion_move_form"/>
            <field name="model">presupuesto.move</field>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='move_rel']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <field name="move_rel" position="after" >
                    <field name="presupuesto_rel_move" widget="many2many_tags" domain="[('doc_type', '=', 'reg')]" String="Compromiso"/>
                    <field name="compute_data" invisible="1"/>
                </field>    

                <xpath expr="//field[@name='gastos_ids']" position="replace">
					<field name="gastos_ids" nolabel='1' context="{'move_id' : id}">
						<tree string="Rubros" editable="bottom" create='false'>
							<field name="move_id" invisible="1" />
							<field name="rubros_id" domain="[('rubro_nivel', '=', 'D'), ('rubro_tipo', '=', 'G')]"/>
							<field name="mov_type" />
							<field name="saldo_move"/>
							<field name="ammount"/>
							<field name="notas"/>
                            <field name="presupuesto_move_name"/>
						</tree>
					</field>
                </xpath>
          

            </field>
        </record>

        <!-- Extending presupuesto pago presupuestal Form View -->
        <record id="view_presupuesto_move_pago_inherit_form" model="ir.ui.view">
           <field name="inherit_id" ref="presupuesto.view_presupuesto_pago_move_form"/>
            <field name="model">presupuesto.move</field>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='move_rel']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <field name="move_rel" position="after" >
                    <field name="presupuesto_rel_move" widget="many2many_tags" domain="[('doc_type', '=', 'obl')]" String="Obligación"/>
                    <field name="compute_data" invisible="1"/>
                </field> 

                <xpath expr="//field[@name='gastos_ids']" position="replace">
					<field name="gastos_ids" nolabel='1' context="{'move_id' : id}">
						<tree string="Rubros" editable="bottom" create='false'>
							<field name="move_id" invisible="1" />
							<field name="rubros_id" domain="[('rubro_nivel', '=', 'D'), ('rubro_tipo', '=', 'G')]"/>
							<field name="mov_type" />
							<field name="saldo_move"/>
							<field name="ammount"/>
							<field name="notas"/>
                            <field name="presupuesto_move_name"/>
						</tree>
					</field>
                </xpath>
 
            </field>
        </record>



        <record id="presupuesto_move_inherit_search_form" model="ir.ui.view">
            <field name="name">presupuesto.move_view_search</field>
            <field name="model">presupuesto.move</field>
            <field name="inherit_id" ref="presupuesto.view_presupuesto_pago_move_search"/>
            <field name="arch" type="xml">
                <field name="name" position="after">
                    <field name="move_rel"/>
                    <field name="partner_id"/>
                </field>

                <xpath expr="/search[@string='Search Pago presupuestal']//filter[2]" position="after">
                    <filter string="Año actual" name="year" domain="[('date','&lt;=', time.strftime('%%Y-12-31')),('date','&gt;=',time.strftime('%%Y-01-01'))]"/>
                </xpath> 


            </field>
        </record>





    </data>
</openerp>
